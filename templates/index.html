{% extends "base.html" %}
{% block title %}Home{% endblock %}

{% block content %}


{% if user %}

    <h3>Job Profiles</h3>
        <!-- Filters Section -->
        <div style="margin-bottom: 20px;">
            <!-- Filter for Deleted Cases -->
            <form action="{{ url_for('index') }}" method="get">
                Show Deleted Cases:
                <select name="show_deleted" onchange="this.form.submit()">
                    <option value="no" {% if request.args.get('show_deleted') == 'no' %}selected{% endif %}>No</option>
                    <option value="yes" {% if request.args.get('show_deleted') == 'yes' %}selected{% endif %}>Yes</option>
                </select>
                <!-- Filter for Job Status -->
                Job Status:
                <select name="job_status" onchange="this.form.submit()">
                    <option value="all">All</option>
                    <option value="draft" {% if request.args.get('job_status') == 'draft' %}selected{% endif %}>Draft</option>
                    <option value="submitted" {% if request.args.get('job_status') == 'submitted' %}selected{% endif %}>Submitted</option>
                    <option value="completed" {% if request.args.get('job_status') == 'completed' %}selected{% endif %}>Completed</option>
                </select>
            </form>
        </div>

    {% if job_profiles %}
        <div style="max-width: 500px;">
            <table style="border-collapse: collapse; width: 100%;">
                <thead>
                    <tr style="border-bottom: 2px solid #000;">
                        <th style="padding: 8px; text-align: left;">
                            Job ID
                            <a href="{{ url_for('index', sort='asc') }}">↑</a>
                            <a href="{{ url_for('index', sort='desc') }}">↓</a>
                        </th>
                        <th style="padding: 8px; text-align: left;">Job Title</th>
                        <th style="padding: 8px; text-align: left;">Job Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for profile in job_profiles %}
                        <tr style="border-bottom: 1px solid #ddd;">
                            <td >
                                <a href="{{ url_for('view_job_profile', job_id=profile.job_id) }}" style="text-decoration: none; color: #333;">
                                    {{ profile.job_id }}
                                </a>
                            </td>
                            <td >
                                <a href="{{ url_for('view_job_profile', job_id=profile.job_id) }}" style="text-decoration: none; color: #333;">
                                    {{ profile.job_title }}
                                </a>
                            </td>

                            <td>
                                <a href="{{ url_for('view_job_profile', job_id=profile.job_id) }}" style="text-decoration: none; color: #333;">

                                    {% if profile.job_status == 'Completed' %}
                                        <span style="color: green;">{{ profile.job_status }}</span>
                                    {% elif profile.job_status == 'Submmited' %}
                                        <span style="color: blue;">{{ profile.job_status }}</span>
                                    {% else %}
                                        <span style="color: orange;">{{ profile.job_status }}</span>
                                    {% endif %}
                                </a>
                            </td>
                            
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <p>No job profiles found.</p>
    {% endif %}
    <a href="{{ url_for('create_job_profile') }}" style="text-decoration: none; ">
        <button style="margin-top: 20px;">Create Job Profile</button>
    </a>


    <!-- Print API information from Azure B2C -->
    <!-- {{user}} -->

{% endif %}



{% if config.get("ENDPOINT") %}
<li><a href='/graphcall'>Call Microsoft Graph API</a></li>
{% endif %}

{% endblock %}
